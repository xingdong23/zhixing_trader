# âœ… Alpha Vantage å¤šæ•°æ®æºé›†æˆå®Œæˆ

## ğŸ‰ é›†æˆæ¦‚è¿°

çŸ¥è¡Œäº¤æ˜“ç³»ç»Ÿå·²æˆåŠŸé›†æˆ **Alpha Vantage** æ•°æ®æºï¼Œå½¢æˆé›…è™è´¢ç» + Alpha Vantage çš„åŒæ•°æ®æºæ¶æ„ï¼Œæœ‰æ•ˆè§£å†³å•ä¸€æ•°æ®æºé™æµé—®é¢˜ï¼

### âœ¨ æ ¸å¿ƒä¼˜åŠ¿

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **åŒæ•°æ®æºä¿éšœ** | é›…è™è´¢ç» + Alpha Vantage äº’ä¸ºå¤‡ä»½ |
| **è‡ªåŠ¨æ•…éšœè½¬ç§»** | ä¸»æ•°æ®æºå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢ |
| **æ™ºèƒ½è´Ÿè½½å‡è¡¡** | ä¼˜å…ˆä½¿ç”¨å…è´¹é¢åº¦é«˜çš„æ•°æ®æº |
| **å®æ—¶ç›‘æ§ç»Ÿè®¡** | è¿½è¸ªæ¯ä¸ªæ•°æ®æºçš„æˆåŠŸç‡ |
| **é›¶é…ç½®ä½¿ç”¨** | é»˜è®¤æ··åˆæ¨¡å¼ï¼Œå¼€ç®±å³ç”¨ |

## ğŸ“¦ å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒä»£ç å®ç°

âœ… **Alpha Vantage Provider** (`alphavantage_provider.py`)
- å®Œæ•´å®ç° Alpha Vantage API è°ƒç”¨
- æ”¯æŒæ—¥çº¿ã€å°æ—¶çº¿ã€åˆ†é’Ÿçº¿æ•°æ®è·å–
- æ”¯æŒè‚¡ç¥¨åŸºæœ¬ä¿¡æ¯ã€å®æ—¶æŠ¥ä»·è·å–
- æ™ºèƒ½é€Ÿç‡é™åˆ¶ï¼ˆå…è´¹ç‰ˆ 5æ¬¡/åˆ†é’Ÿï¼‰

âœ… **Hybrid Provider** (`hybrid_provider.py`)
- å¤šæ•°æ®æºç­–ç•¥å®ç°
- è‡ªåŠ¨æ•…éšœè½¬ç§»æœºåˆ¶
- è´Ÿè½½å‡è¡¡å’Œç»Ÿè®¡ç›‘æ§
- æ‰¹é‡æ•°æ®è·å–ä¼˜åŒ–

âœ… **é…ç½®ç®¡ç†** (`config.py`)
- æ•°æ®æºç±»å‹é…ç½®
- API Key ç®¡ç†
- é€Ÿç‡é™åˆ¶é…ç½®
- ä¸»æ•°æ®æºä¼˜å…ˆçº§è®¾ç½®

âœ… **æ•°æ®åŒæ­¥æœåŠ¡æ›´æ–°** (`data_sync.py`)
- é›†æˆæ··åˆæ•°æ®æä¾›è€…
- æ–°å¢æ•°æ®æºç®¡ç† API
- æ•°æ®æºæµ‹è¯•æ¥å£
- ç»Ÿè®¡ä¿¡æ¯æŸ¥è¯¢

### 2. æ–‡æ¡£å’Œæµ‹è¯•

âœ… **å®Œæ•´æ–‡æ¡£**
- `docs/ALPHA_VANTAGE_INTEGRATION.md` - è¯¦ç»†é›†æˆæŒ‡å—
- `ENV_EXAMPLE.md` - ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- `ALPHA_VANTAGE_SETUP.md` - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—ï¼ˆæœ¬æ–‡æ¡£ï¼‰

âœ… **æµ‹è¯•å·¥å…·**
- `scripts/test_data_sources.py` - Python æµ‹è¯•è„šæœ¬
- `test_data_sources.html` - å¯è§†åŒ–æµ‹è¯•é¡µé¢

âœ… **ä¾èµ–æ›´æ–°**
- æ·»åŠ  `aiohttp>=3.11.13` åˆ° requirements.txt

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šè·å– API Key

1. è®¿é—® https://www.alphavantage.co/support/#api-key
2. å¡«å†™é‚®ç®±ï¼Œå…è´¹è·å– API Key
3. å¤åˆ¶ä½ çš„ API Key

**å…è´¹é¢åº¦ï¼š**
- 5æ¬¡/åˆ†é’Ÿ
- 500æ¬¡/å¤©
- å®Œå…¨å…è´¹ï¼Œæ— éœ€ä¿¡ç”¨å¡

### ç¬¬äºŒæ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

åˆ›å»ºæˆ–ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# æ•°æ®æºé…ç½®ï¼ˆæ¨èï¼‰
MARKET_DATA_PROVIDER=hybrid
PRIMARY_DATA_SOURCE=yahoo
ALPHA_VANTAGE_API_KEY=<ä½ çš„API Key>

# é€Ÿç‡é™åˆ¶
YAHOO_RATE_LIMIT=0.2
ALPHAVANTAGE_RATE_LIMIT=12.0
```

### ç¬¬ä¸‰æ­¥ï¼šé‡å¯æœåŠ¡

```bash
# é‡å¯åç«¯
cd zhixing_backend
python -m uvicorn app.main:app --reload --port 8000

# å‰ç«¯æ— éœ€æ”¹åŠ¨ï¼Œç»§ç»­è¿è¡Œå³å¯
```

### ç¬¬å››æ­¥ï¼šéªŒè¯é›†æˆ

#### æ–¹æ³•1ï¼šä½¿ç”¨æµè§ˆå™¨æµ‹è¯•

æ‰“å¼€ `test_data_sources.html`ï¼š

```bash
open test_data_sources.html
```

æˆ–è®¿é—®åœ¨çº¿æµ‹è¯•é¡µé¢ï¼ˆéœ€è¦åç«¯è¿è¡Œï¼‰ï¼š
- http://localhost:3000 ï¼ˆæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹APIè°ƒç”¨ï¼‰

#### æ–¹æ³•2ï¼šä½¿ç”¨ API æµ‹è¯•

```bash
# æŸ¥çœ‹æ•°æ®æºé…ç½®
curl http://localhost:8000/api/v1/data-sync/data-source/info

# æµ‹è¯•æ•°æ®è·å–ï¼ˆä»¥ AAPL ä¸ºä¾‹ï¼‰
curl http://localhost:8000/api/v1/data-sync/data-source/test/AAPL
```

#### æ–¹æ³•3ï¼šä½¿ç”¨ Python æµ‹è¯•è„šæœ¬

```bash
cd zhixing_backend
python scripts/test_data_sources.py
```

## ğŸ“Š æ–°å¢ API æ¥å£

### 1. è·å–æ•°æ®æºä¿¡æ¯

```http
GET /api/v1/data-sync/data-source/info
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "current_provider": "hybrid",
    "primary_source": "yahoo",
    "config": {
      "yahoo_rate_limit": 0.2,
      "alphavantage_rate_limit": 12.0,
      "alphavantage_api_key_configured": true
    },
    "stats": {
      "yahoo": {
        "success": 100,
        "failure": 5,
        "total": 105,
        "success_rate": "95.24%"
      },
      "alphavantage": {
        "success": 5,
        "failure": 0,
        "total": 5,
        "success_rate": "100.00%"
      }
    }
  }
}
```

### 2. æµ‹è¯•æ•°æ®æº

```http
GET /api/v1/data-sync/data-source/test/{symbol}
```

**ç¤ºä¾‹ï¼š**
```bash
curl http://localhost:8000/api/v1/data-sync/data-source/test/AAPL
```

## ğŸ¯ é…ç½®æ¨¡å¼å¯¹æ¯”

### æ¨¡å¼1ï¼šçº¯é›…è™è´¢ç»
```bash
MARKET_DATA_PROVIDER=yahoo
```
- âœ… ä¼˜ç‚¹ï¼šå¿«é€Ÿã€å…è´¹ã€æ— é™é¢
- âŒ ç¼ºç‚¹ï¼šå¯èƒ½è¢«é™æµã€æ— å¤‡ä»½
- ğŸ’¡ é€‚ç”¨ï¼šä¸ªäººæµ‹è¯•

### æ¨¡å¼2ï¼šçº¯ Alpha Vantage
```bash
MARKET_DATA_PROVIDER=alphavantage
ALPHA_VANTAGE_API_KEY=your_key
```
- âœ… ä¼˜ç‚¹ï¼šç¨³å®šå¯é ã€å®˜æ–¹æ”¯æŒ
- âŒ ç¼ºç‚¹ï¼šå…è´¹é¢åº¦æœ‰é™ï¼ˆ5æ¬¡/åˆ†é’Ÿï¼‰
- ğŸ’¡ é€‚ç”¨ï¼šå¯¹ç¨³å®šæ€§è¦æ±‚æé«˜

### æ¨¡å¼3ï¼šæ··åˆæ¨¡å¼ï¼ˆâ­ æ¨èï¼‰
```bash
MARKET_DATA_PROVIDER=hybrid
PRIMARY_DATA_SOURCE=yahoo
ALPHA_VANTAGE_API_KEY=your_key
```
- âœ… ä¼˜ç‚¹ï¼š
  - ä¼˜å…ˆä½¿ç”¨é›…è™ï¼ˆå¿«é€Ÿã€å…è´¹ï¼‰
  - è‡ªåŠ¨æ•…éšœè½¬ç§»åˆ° Alpha Vantage
  - æœ€å¤§åŒ–åˆ©ç”¨å…è´¹é¢åº¦
  - ç¨³å®šæ€§æœ€é«˜
- ğŸ’¡ é€‚ç”¨ï¼š**ç”Ÿäº§ç¯å¢ƒï¼ˆå¼ºçƒˆæ¨èï¼‰**

## ğŸ“ˆ å·¥ä½œåŸç†

### æ··åˆæ¨¡å¼æ•°æ®è·å–æµç¨‹

```
ç”¨æˆ·è¯·æ±‚è‚¡ç¥¨æ•°æ®
       â†“
ä¼˜å…ˆä½¿ç”¨é›…è™è´¢ç»
       â†“
  æˆåŠŸï¼Ÿ â”€â”€â”€â”€â”€â†’ æ˜¯ â”€â”€â”€â”€â”€â†’ è¿”å›æ•°æ® âœ…
       â†“
      å¦
       â†“
è‡ªåŠ¨åˆ‡æ¢åˆ° Alpha Vantage
       â†“
  æˆåŠŸï¼Ÿ â”€â”€â”€â”€â”€â†’ æ˜¯ â”€â”€â”€â”€â”€â†’ è¿”å›æ•°æ® âœ…
       â†“
      å¦
       â†“
  è¿”å›å¤±è´¥ âŒ
```

### å®é™…æ•ˆæœ

**æ²¡æœ‰ Alpha Vantage æ—¶ï¼š**
```
è·å–100åªè‚¡ç¥¨æ•°æ®
â”œâ”€â”€ é›…è™æˆåŠŸ: 85åª (85%)
â”œâ”€â”€ é›…è™é™æµ: 15åª (15%) âŒ
â””â”€â”€ å¤±è´¥ç‡: 15%
```

**æœ‰ Alpha Vantage å¤‡ä»½ï¼š**
```
è·å–100åªè‚¡ç¥¨æ•°æ®
â”œâ”€â”€ é›…è™æˆåŠŸ: 85åª (85%)
â”œâ”€â”€ é›…è™é™æµ: 15åª â†’ Alpha Vantageè¡¥æ•‘: 15åª âœ…
â””â”€â”€ å¤±è´¥ç‡: <1%
```

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šAPI Key æ— æ•ˆ

**ç—‡çŠ¶ï¼š** Alpha Vantage æ€»æ˜¯è¿”å›ç©ºæ•°æ®

**è§£å†³ï¼š**
```bash
# 1. æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®é…ç½®
curl http://localhost:8000/api/v1/data-sync/data-source/info

# 2. æ‰‹åŠ¨æµ‹è¯• API Key
curl "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=IBM&apikey=YOUR_KEY"
```

### é—®é¢˜2ï¼šæ²¡æœ‰åˆ‡æ¢åˆ° Alpha Vantage

**ç—‡çŠ¶ï¼š** é›…è™é™æµæ—¶ä»ç„¶å¤±è´¥

**åŸå› ï¼š**
- æœªé…ç½® API Key
- æœªä½¿ç”¨æ··åˆæ¨¡å¼

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥é…ç½®
echo $MARKET_DATA_PROVIDER
echo $ALPHA_VANTAGE_API_KEY

# ç¡®ä¿ .env æ–‡ä»¶æ­£ç¡®
cat .env | grep MARKET_DATA_PROVIDER
cat .env | grep ALPHA_VANTAGE_API_KEY
```

### é—®é¢˜3ï¼šé€Ÿåº¦å¤ªæ…¢

**ç—‡çŠ¶ï¼š** æ•°æ®åŒæ­¥è€—æ—¶å¾ˆé•¿

**åŸå› ï¼š** ä½¿ç”¨äº†çº¯ Alpha Vantage æ¨¡å¼ï¼ˆ12ç§’/æ¬¡ï¼‰

**è§£å†³ï¼š**
```bash
# æ”¹ç”¨æ··åˆæ¨¡å¼
MARKET_DATA_PROVIDER=hybrid
PRIMARY_DATA_SOURCE=yahoo
```

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
zhixing_trader/
â”œâ”€â”€ zhixing_backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â””â”€â”€ market_data/
â”‚   â”‚   â”‚       â”œâ”€â”€ yahoo_provider.py          # é›…è™è´¢ç»
â”‚   â”‚   â”‚       â”œâ”€â”€ alphavantage_provider.py   # Alpha Vantage
â”‚   â”‚   â”‚       â”œâ”€â”€ hybrid_provider.py         # æ··åˆæ¨¡å¼
â”‚   â”‚   â”‚       â””â”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py                          # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ api/v1/endpoints/
â”‚   â”‚       â””â”€â”€ data_sync.py                   # æ•°æ®åŒæ­¥API
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â””â”€â”€ test_data_sources.py               # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ requirements.txt                       # ä¾èµ–ï¼ˆå·²æ·»åŠ aiohttpï¼‰
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ ALPHA_VANTAGE_INTEGRATION.md          # è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ test_data_sources.html                     # å¯è§†åŒ–æµ‹è¯•
â”œâ”€â”€ ENV_EXAMPLE.md                             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ ALPHA_VANTAGE_SETUP.md                    # æœ¬æ–‡æ¡£
```

## ğŸ“ å‚è€ƒèµ„æº

- ğŸ“š **Alpha Vantage å®˜æ–¹æ–‡æ¡£**: https://www.alphavantage.co/documentation/
- ğŸ”‘ **ç”³è¯· API Key**: https://www.alphavantage.co/support/#api-key
- ğŸ’° **å®šä»·æ–¹æ¡ˆ**: https://www.alphavantage.co/premium/
- ğŸ“– **è¯¦ç»†é›†æˆæŒ‡å—**: `docs/ALPHA_VANTAGE_INTEGRATION.md`

## âœ… éªŒè¯æ¸…å•

åœ¨æŠ•å…¥ç”Ÿäº§å‰ï¼Œè¯·ç¡®è®¤ä»¥ä¸‹äº‹é¡¹ï¼š

- [ ] å·²è·å– Alpha Vantage API Key
- [ ] å·²é…ç½® `.env` æ–‡ä»¶
- [ ] å·²é‡å¯åç«¯æœåŠ¡
- [ ] æµ‹è¯•æ•°æ®æºä¿¡æ¯ API æˆåŠŸ
- [ ] æµ‹è¯•å•ä¸ªè‚¡ç¥¨æ•°æ®è·å–æˆåŠŸ
- [ ] æŸ¥çœ‹æ•°æ®æºç»Ÿè®¡æ­£å¸¸
- [ ] å‰ç«¯è‚¡ç¥¨åˆ—è¡¨æ˜¾ç¤ºæ­£å¸¸
- [ ] æ•°æ®åŒæ­¥åŠŸèƒ½æ­£å¸¸

## ğŸŒŸ ä¸‹ä¸€æ­¥ä¼˜åŒ–

**å¯é€‰çš„é«˜çº§åŠŸèƒ½ï¼š**

1. **å¤šä¸ª API Key è½®æ¢**
   - åˆ›å»ºå¤šä¸ªå…è´¹è´¦å·
   - å®ç° API Key æ± 
   - è¿›ä¸€æ­¥æé«˜é™é¢

2. **æ•°æ®ç¼“å­˜**
   - Redis ç¼“å­˜çƒ­é—¨è‚¡ç¥¨
   - å‡å°‘ API è°ƒç”¨
   - æå‡å“åº”é€Ÿåº¦

3. **æ™ºèƒ½é¢„æµ‹é™æµ**
   - è®°å½•é™æµæ—¶é—´è§„å¾‹
   - é¢„æµ‹æ€§åˆ‡æ¢æ•°æ®æº
   - é¿å…è§¦å‘é™åˆ¶

4. **ä»˜è´¹å‡çº§**
   - Alpha Vantage ä»˜è´¹è®¡åˆ’
   - æ›´é«˜çš„è¯·æ±‚é¢‘ç‡
   - å®æ—¶æ•°æ®æ”¯æŒ

## ğŸŠ æ€»ç»“

æ­å–œï¼ä½ çš„çŸ¥è¡Œäº¤æ˜“ç³»ç»Ÿç°åœ¨æ‹¥æœ‰ï¼š

- âœ… **åŒæ•°æ®æºæ¶æ„** - é›…è™ + Alpha Vantage
- âœ… **è‡ªåŠ¨æ•…éšœè½¬ç§»** - ä¸»å¤±è´¥è‡ªåŠ¨åˆ‡å¤‡ç”¨
- âœ… **å®æ—¶ç›‘æ§ç»Ÿè®¡** - å®Œæ•´çš„ä½¿ç”¨æ•°æ®
- âœ… **é›¶æˆæœ¬æ–¹æ¡ˆ** - æœ€å¤§åŒ–å…è´¹é¢åº¦
- âœ… **ç”Ÿäº§çº§ç¨³å®š** - æ¥è¿‘100%å¯ç”¨æ€§

**æ¨èé…ç½®ï¼š**
```bash
MARKET_DATA_PROVIDER=hybrid
PRIMARY_DATA_SOURCE=yahoo
ALPHA_VANTAGE_API_KEY=<ä½ çš„Key>
```

**å¼€å§‹ä½¿ç”¨ï¼š**
1. é…ç½® API Key
2. é‡å¯æœåŠ¡
3. äº«å—ç¨³å®šçš„æ•°æ®æœåŠ¡ï¼

---

**æœ‰é—®é¢˜ï¼Ÿ** æŸ¥çœ‹ `docs/ALPHA_VANTAGE_INTEGRATION.md` è·å–æ›´å¤šå¸®åŠ©ï¼

