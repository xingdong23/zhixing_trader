# 📊 多级分类树集成到自选股 - 使用指南

## ✅ 已完成集成

恭喜！多级分类树系统已经成功集成到自选股主页！

## 🎯 新功能位置

打开自选股主页，你会在**股票列表上方**看到：

### 1. **多级分类选择器**（新增）
```
股票分类: [清除筛选] [标签模式/树形模式] [管理分类]
├─ 🤖 人工智能 (15) +2.3%
│  ├─ ⚡ 算力 (8) +3.1%
│  │  ├─ 💾 芯片 (5) +4.2%
│  │  └─ ☁️ 云计算 (3) +2.0%
│  └─ 🎯 AI应用 (7) +1.5%
├─ ⚡ 新能源 (12) +1.8%
│  ├─ 🔋 电池 (6) +2.5%
│  └─ ☀️ 光伏 (6) +1.1%
└─ 💊 生物医药 (10) -0.5%
```

### 2. **传统概念标签**（保留）
在没有选中分类时，下方会显示原有的概念标签系统

## 🚀 如何使用

### 方式1：树形模式（默认）
1. 在分类选择器中看到完整的层级结构
2. 点击分类名称即可筛选该分类下的股票
3. 点击箭头可以展开/收起子分类
4. 可以看到每个分类的涨跌幅（红色上涨，绿色下跌）

### 方式2：标签模式
1. 点击右上角"标签模式"切换
2. 所有分类平铺显示为标签
3. 点击标签快速筛选

### 方式3：传统概念筛选
1. 不选择任何分类
2. 使用下方的传统概念标签
3. 保持原有的筛选方式

## 🎨 功能特点

### ✨ 新增能力
- **多级层级**：支持无限深度的分类树
- **实时涨跌幅**：每个分类显示平均涨跌幅
- **智能筛选**：选择分类后只显示该分类的股票
- **快速切换**：树形/标签两种模式随意切换
- **一键清除**：点击"清除筛选"恢复全部股票

### 📊 数据展示
- 显示分类名称和图标
- 显示股票数量（包含子分类）
- 显示平均涨跌幅（有价格数据的股票）
- 颜色编码：红涨绿跌

### 🔗 与原系统集成
- **不影响原有功能**：传统概念筛选依然可用
- **互斥选择**：选择分类后，概念筛选自动隐藏
- **价格排序**：支持按价格、涨跌幅排序
- **价格筛选**：保留原有的价格范围筛选

## 📸 使用场景

### 场景1：板块轮动监控
```
1. 打开自选股页面
2. 查看分类树中的涨跌幅
3. 快速发现强势板块（显示为红色）
4. 点击该板块查看具体股票
```

### 场景2：细分领域深挖
```
1. 点击"人工智能"查看AI板块
2. 展开"算力"子分类
3. 点击"芯片"查看芯片股
4. 集中资金布局细分龙头
```

### 场景3：多级对比
```
1. 树形模式下一眼看到各级涨跌幅
2. 对比"电池"和"光伏"的表现
3. 选择更强的细分方向
4. 快速切换查看股票列表
```

## 🎛️ 操作技巧

### 快捷操作
- **双击分类**：快速展开/收起（开发中）
- **右键菜单**：管理分类（开发中）
- **拖拽排序**：调整分类顺序（开发中）

### 键盘快捷键（计划中）
- `Ctrl/Cmd + F`：快速搜索分类
- `Esc`：清除当前筛选
- `Space`：展开/收起选中分类

## 🔧 管理分类

### 添加股票到分类
1. 点击右上角"管理分类"
2. 进入分类管理页面
3. 选择分类并添加股票

### 创建新分类
1. 在分类管理页面
2. 点击"添加根分类"或某个分类的"+"
3. 输入名称并保存

### 调整分类结构
1. 在分类管理页面
2. 可以移动分类位置
3. 可以调整父子关系

## 📈 数据说明

### 涨跌幅计算
- **平均涨跌幅**：该分类下所有股票的平均涨跌幅
- **加权涨跌幅**：根据设置的权重计算（在热力图中使用）
- **实时更新**：每次加载页面时自动更新

### 股票数量
- **直接数量**：直接关联到该分类的股票数
- **总数量**：包含所有子分类的股票总数（显示的数字）

## 🎯 与独立分类页面的区别

| 特性 | 自选股集成版 | 独立分类页面 |
|------|------------|------------|
| 位置 | 自选股顶部 | /categories路由 |
| 样式 | 紧凑模式 | 完整展示 |
| 功能 | 快速筛选 | 完整管理 |
| 热力图 | 涨跌幅标注 | 独立热力图 |
| 操作 | 选择筛选 | 增删改查 |

**建议使用场景：**
- **自选股页面**：日常快速筛选和查看
- **分类管理页面**：深度管理和热力图分析

## 🐛 常见问题

### Q1: 为什么看不到涨跌幅？
**A:** 需要先执行数据同步，确保股票有价格数据。点击页面上的"同步数据"按钮。

### Q2: 如何创建自己的分类？
**A:** 点击"管理分类"按钮，进入完整的分类管理页面进行创建。

### Q3: 分类和概念有什么区别？
**A:** 
- **分类**：多级树形结构，你可以自定义
- **概念**：单层标签，系统预设或批量导入

### Q4: 可以同时使用分类和概念筛选吗？
**A:** 不可以，它们是互斥的。选择分类后，概念筛选会自动隐藏。

### Q5: 数据多久更新一次？
**A:** 每次刷新页面时自动加载最新数据。热力图数据基于最新的K线价格。

## 🔄 更新日志

### v1.0 (2025-10-16)
- ✅ 多级分类树选择器
- ✅ 实时涨跌幅显示
- ✅ 树形/标签模式切换
- ✅ 与自选股页面深度集成
- ✅ 保留传统概念筛选
- ✅ 支持价格排序和筛选

## 🎉 开始使用

现在就打开你的自选股页面体验新功能吧！

```bash
# 1. 确保服务运行
http://localhost:3000

# 2. 点击左侧"自选股票"
# 3. 在股票列表上方就能看到分类选择器
# 4. 点击任意分类开始筛选！
```

## 📞 技术支持

- 使用指南：`docs/CATEGORY_SYSTEM_GUIDE.md`
- 功能总结：`CATEGORY_FEATURE_SUMMARY.md`
- API文档：http://localhost:8000/docs
- 测试页面：`test_category_system.html`

祝你投资顺利！ 🚀📈💰

