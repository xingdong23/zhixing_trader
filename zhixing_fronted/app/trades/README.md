# 我的交易模块 - 前端文档

## 概述

"我的交易"模块是交易日志系统的核心功能，提供完整的交易生命周期管理，从交易计划创建到平仓复盘的全流程支持。

## 功能特性

### 1. 三个主要视图

#### 正在交易
- 显示当前所有持仓
- 实时显示浮动盈亏
- 支持查看详情、编辑止损止盈
- 显示持仓天数、关联笔记和截图数量

#### 等待执行
- 显示所有待执行的交易计划
- 支持编辑计划参数
- 可以取消计划或转为执行状态
- 显示计划创建时间和提醒设置

#### 历史记录
- 显示所有已平仓的交易
- 显示最终盈亏结果
- 支持复盘评分和笔记
- 提供统计分析功能

### 2. 交易计划创建

- **基本信息**：股票代码、名称
- **交易类型**：做多/做空
- **价格设置**：
  - 计划入场价
  - 入场价格区间（低-高）
  - 止损价
  - 止盈价
- **数量设置**：计划交易数量
- **策略思路**：记录交易策略和入场理由
- **计划笔记**：记录计划阶段的想法

### 3. 交易详情

详情页面采用标签页设计，包含：

#### 概览标签
- 持仓概览（入场价、当前价、盈亏）
- 交易计划信息
- 止损止盈设置
- 执行信息
- 平仓信息（已平仓交易）

#### 笔记标签
- 显示关联的所有笔记
- 按阶段分组（计划、入场、持仓、平仓、复盘）
- 支持快速添加新笔记

#### 截图标签
- 显示上传的K线截图
- 按阶段和类型分组
- 支持拖拽上传

#### 提醒标签
- 显示活跃的提醒
- 支持创建价格、时间、盈亏提醒
- 显示提醒历史

#### 时间线标签
- 按时间顺序显示交易事件
- 包括：计划创建、开仓、调整、平仓等
- 可视化展示交易全流程

### 4. 筛选功能

支持多维度筛选：
- **股票代码**：模糊搜索
- **交易类型**：做多/做空
- **日期范围**：开始日期-结束日期
- **盈亏范围**：最小-最大盈亏
- **交易状态**：多选状态筛选

### 5. 统计面板

#### 总体统计
- 总交易数
- 持仓中数量
- 胜率
- 总盈亏

#### 当前视图统计
- 根据当前标签页动态显示
- 正在交易：浮动盈亏汇总
- 历史记录：已实现盈亏、胜率

## 组件结构

```
app/trades/
├── page.tsx              # 主页面
├── types.ts              # 类型定义
└── README.md            # 文档

components/trades/
├── TradeCard.tsx         # 交易卡片组件
├── TradeFilters.tsx      # 筛选组件
├── TradePlanForm.tsx     # 交易计划表单
└── TradeDetail.tsx       # 交易详情组件
```

## 数据结构

### Trade（交易记录）

```typescript
interface Trade {
  id: number;
  symbol: string;              // 股票代码
  stockName: string;           // 股票名称
  status: TradeStatus;         // 交易状态
  planType: TradeType;         // 交易类型：做多/做空
  
  // 计划阶段
  planEntryPrice?: number;
  planQuantity?: number;
  planStopLoss?: number;
  planTakeProfit?: number;
  planStrategy?: string;
  planNotes?: string;
  
  // 执行阶段
  entryPrice?: number;
  entryTime?: string;
  entryQuantity?: number;
  
  // 持仓阶段
  currentPrice?: number;
  currentQuantity?: number;
  unrealizedPnl?: number;
  unrealizedPnlPct?: number;
  
  // 平仓阶段
  exitPrice?: number;
  exitTime?: string;
  netPnl?: number;
  realizedPnlPct?: number;
  
  // 复盘
  reviewRating?: number;
  reviewNotes?: string;
}
```

## Mock 数据

当前使用 Mock 数据进行前端演示，包括：
- 6个交易记录（2个持仓中、2个等待执行、2个已平仓）
- 完整的统计数据
- 模拟的笔记和截图数量

## 使用指南

### 创建交易计划

1. 点击右上角"创建交易计划"按钮
2. 填写股票代码和基本信息
3. 选择交易类型（做多/做空）
4. 设置入场价格和数量
5. 设置止损止盈价格
6. 填写交易策略和笔记
7. 点击"保存"创建计划

### 查看交易详情

1. 在交易卡片上点击"眼睛"图标
2. 查看不同标签页的详细信息
3. 可以在详情页添加笔记、截图、提醒

### 筛选交易

1. 展开筛选器面板
2. 选择筛选条件（代码、类型、日期等）
3. 点击状态标签进行多选筛选
4. 点击"清空"重置所有筛选条件

### 切换视图

1. 点击顶部的标签页切换按钮
2. 查看不同状态的交易
3. 每个视图显示对应的统计数据

## 界面截图

### 主界面布局
```
┌─────────────────────────────────────────────────────────┐
│  我的交易                          [创建交易计划]        │
├─────────────────────────────────────────────────────────┤
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐          │
│  │总交易数│ │持仓中  │ │胜率    │ │总盈亏  │          │
│  └────────┘ └────────┘ └────────┘ └────────┘          │
├─────────────────────────────────────────────────────────┤
│  [正在交易] [等待执行] [历史记录]                       │
├─────────────────────────────────────────────────────────┤
│  当前视图统计面板                                        │
├─────────────────────────────────────────────────────────┤
│  筛选器                                                  │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────┐    │
│  │ AAPL - Apple Inc.            [查看详情] [编辑] │    │
│  │ 入场: $180.80 → 当前: $185.20 (+2.43%)         │    │
│  │ 数量: 100股 | 浮动盈亏: +$440.00               │    │
│  │ 止损: $177.00 | 止盈: $190.00                  │    │
│  │ 📝 3  📸 2  🔔 2  ⏱️ 3天                       │    │
│  └─────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────┘
```

## 样式设计

### 主题色彩
- **做多**：绿色系（#10b981）
- **做空**：红色系（#ef4444）
- **盈利**：绿色文字
- **亏损**：红色文字
- **状态徽章**：不同颜色标识不同状态

### 响应式设计
- 桌面端：4列网格布局
- 平板端：2列网格布局
- 移动端：单列布局
- 所有组件支持深色模式

### 交互反馈
- 卡片悬停：阴影效果
- 按钮点击：视觉反馈
- 表单验证：实时提示
- 加载状态：加载指示器

## 下一步开发

### 待实现功能（需要后端支持）

1. **交易执行**
   - 开仓操作
   - 加仓/减仓
   - 平仓操作
   - 调整止损止盈

2. **笔记和截图**
   - 关联笔记到交易
   - 上传K线截图
   - 图片预览和管理

3. **提醒系统**
   - 创建价格提醒
   - 创建时间提醒
   - 创建盈亏提醒
   - 提醒通知

4. **实时数据**
   - WebSocket 价格推送
   - 自动更新盈亏
   - 实时触发提醒

5. **高级功能**
   - 交易统计分析
   - 按策略分组
   - 导出交易记录
   - 批量操作

## 技术栈

- **框架**：Next.js 14 + React 18
- **UI组件**：shadcn/ui + Radix UI
- **样式**：Tailwind CSS
- **图标**：Lucide React
- **状态管理**：React Hooks (useState, useMemo)
- **路由**：Next.js App Router

## 性能优化

1. **计算优化**
   - 使用 `useMemo` 缓存筛选结果
   - 使用 `useMemo` 缓存统计计算

2. **渲染优化**
   - 组件按需加载
   - 列表虚拟化（待实现）
   - 图片懒加载（待实现）

3. **用户体验**
   - 乐观更新
   - 加载骨架屏（待实现）
   - 错误边界处理（待实现）

## 常见问题

### Q: 如何修改 Mock 数据？
A: 编辑 `app/trades/page.tsx` 中的 `mockTrades` 数组。

### Q: 如何添加新的筛选条件？
A: 在 `types.ts` 中更新 `TradeFilters` 接口，然后在 `TradeFilters.tsx` 组件中添加对应的 UI。

### Q: 如何自定义交易状态？
A: 修改 `types.ts` 中的 `TradeStatus` 类型和 `TradeCard.tsx` 中的 `statusConfig`。

### Q: 如何接入真实后端？
A: 创建 API 调用函数，替换 Mock 数据，添加错误处理和加载状态。

## 版本历史

- **v1.0** (2024-10-18)
  - 初始版本
  - 实现核心界面和组件
  - 使用 Mock 数据演示

---

**文档版本**: v1.0  
**创建日期**: 2024-10-18  
**最后更新**: 2024-10-18  
**维护者**: QuantMind Team

