# 股票笔记时间线功能说明

## 功能概述

在股票详情页面中新增了**投资笔记时间线**功能，帮助投资者：
- 📝 记录对股票的判断和分析
- 💬 与其他投资者进行讨论
- 📊 清晰展示投资逻辑的演变过程
- 🎯 设定价格目标并跟踪

## 核心特性

### 1. 时间轴展示
- **垂直时间线**：按时间顺序展示所有笔记
- **视觉节点**：不同判断类型有不同的图标和颜色
- **清晰层次**：主笔记和评论有明显的视觉区分

### 2. 判断类型

支持 7 种判断类型，每种都有独特的视觉标识：

| 类型 | 说明 | 颜色 |
|------|------|------|
| 🟢 看涨 | 预期价格上涨 | 绿色 |
| 🔴 看跌 | 预期价格下跌 | 红色 |
| ⚪ 中性 | 观望或震荡 | 灰色 |
| 🔵 价格目标 | 设定目标价位 | 蓝色 |
| 🟠 风险提示 | 潜在风险警示 | 橙色 |
| 🟢 入场点 | 建议买入时机 | 翠绿色 |
| 🟣 出场点 | 建议卖出时机 | 紫色 |

### 3. 价格目标功能

当选择"价格目标"类型时：
- 可以设定具体的目标价格
- 自动计算与当前价格的差距（百分比）
- 在笔记中突出显示价格对比

### 4. 嵌套评论系统

类似论坛的讨论功能：
- **顶级评论**：直接回复笔记
- **嵌套回复**：可以回复其他人的评论
- **多层讨论**：支持无限层级的讨论
- **视觉缩进**：通过缩进清晰展示讨论层级

### 5. 互动功能

- 👍 **点赞**：为笔记和评论点赞
- 💬 **评论**：发表你的观点
- 🔄 **回复**：回复特定的评论
- 📊 **统计**：显示点赞数和评论数

## 使用场景

### 场景 1：记录投资决策
```
张三 - 2025-01-15 14:30 - 看涨
目标价格: $195.00 (当前 $183.25, +6.41%)

AAPL 目前处于上升通道，RSI 指标显示未超买，建议逢低买入。
从技术面看，股价已突破 55 日均线，成交量放大，显示多头力量增强。
```

### 场景 2：多人讨论
```
张三的笔记
  └─ 李四：我不太同意，目前市场整体偏弱...
      └─ 张三：确实有调整风险，但长期看好...
```

### 场景 3：风险提示
```
王五 - 2025-01-18 10:15 - 风险提示

注意！AAPL 即将发布财报，历史上财报前后波动较大，建议控制仓位。
```

## 技术实现

### 组件结构

```
TimelineNotes (主组件)
├── TimelineNoteItem (单个笔记)
│   ├── 时间轴节点
│   ├── 笔记内容
│   ├── 价格目标卡片
│   └── CommentItem (评论)
│       └── CommentItem (嵌套回复)
└── AddTimelineNoteDialog (添加笔记对话框)
```

### 数据结构

```typescript
interface TimelineNote {
  id: string
  author: string
  content: string
  timestamp: string
  judgmentType: JudgmentType
  priceTarget?: number
  currentPrice?: number
  likes: number
  comments: Comment[]
}

interface Comment {
  id: string
  author: string
  content: string
  timestamp: string
  likes: number
  replies?: Comment[]  // 支持嵌套
}
```

## 访问方式

1. 访问股票详情页：`http://localhost:3001/stock/AAPL`
2. 在页面中找到"投资笔记时间线"部分
3. 点击"添加笔记"按钮开始使用

## 未来扩展

- [ ] 笔记搜索和筛选
- [ ] 按判断类型筛选
- [ ] 导出笔记为 PDF
- [ ] 笔记提醒功能
- [ ] 与交易计划关联
- [ ] 笔记的编辑和删除
- [ ] @提及其他用户
- [ ] 图片和图表上传
- [ ] 笔记的隐私设置（公开/私密）

## 设计亮点

1. **清晰的视觉层次**：通过颜色、图标、缩进等方式区分不同类型的内容
2. **论坛式讨论**：支持多层嵌套回复，便于深入讨论
3. **时间轴形式**：一眼看出投资逻辑的演变
4. **价格跟踪**：自动计算目标价格与当前价格的差距
5. **响应式设计**：适配各种屏幕尺寸

## 示例截图位置

页面位于：`/stock/[symbol]`
组件位于：`/components/stocks/TimelineNotes.tsx`
