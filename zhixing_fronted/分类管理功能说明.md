# 📁 分类管理功能说明

## 功能概述

新增"分类"独立菜单,与"股票"菜单同级,无需跳转到其他页面即可直接管理股票分类。

---

## ✨ 主要功能

### 1. 独立的分类管理界面

**位置**: 左侧菜单 → 📁 分类

**功能**:
- ✅ 查看所有分类(树形结构)
- ✅ 创建新分类
- ✅ 编辑分类
- ✅ 删除分类
- ✅ 支持多级嵌套
- ✅ 实时统计股票数量

---

## 🎨 界面布局

### 顶部统计
3个统计卡片:
- **总分类数**: 所有分类的总数量
- **顶级分类**: 一级分类的数量
- **总股票数**: 所有分类下的股票总数

### 分类列表
树形展示,每个分类显示:
- 📁 图标(可自定义)
- 分类名称
- 分类路径
- 股票数量(本分类 + 总计)
- 操作按钮(编辑/删除)

---

## 📋 功能详解

### 1. 创建分类

**操作步骤**:
1. 点击右上角"创建分类"按钮
2. 填写表单:
   - **分类名称** (必填): 例如"科技股"、"能源板块"
   - **父分类** (可选): 选择上级分类,留空则为顶级分类
   - **图标** (可选): 从12个图标中选择
     - 📁 📂 ⭐ 🎯 💼 🏢 🚀 💡 🔥 ⚡ 🌟 📊
   - **颜色** (可选): 从7种颜色中选择
     - 蓝色/绿色/红色/黄色/紫色/粉色/灰色
3. 点击"创建"按钮

**示例**:
- 创建顶级分类"行业板块"
- 在"行业板块"下创建子分类"科技股"
- 在"科技股"下创建子分类"AI算力"

---

### 2. 编辑分类

**操作步骤**:
1. 鼠标悬停在分类上
2. 点击"编辑"按钮(✏️)
3. 修改信息
4. 点击"更新"按钮

**可编辑项**:
- ✅ 分类名称
- ✅ 父分类(可以移动到其他分类下)
- ✅ 图标
- ✅ 颜色

---

### 3. 删除分类

**操作步骤**:
1. 鼠标悬停在分类上
2. 点击"删除"按钮(🗑️)
3. 确认删除

**注意**:
- ⚠️ 删除分类会同时删除所有子分类
- ⚠️ 分类下的股票会移至"未分类"
- ⚠️ 操作不可撤销,请谨慎操作

---

### 4. 树形展示

**特性**:
- ✅ 支持多级嵌套(无限层级)
- ✅ 展开/折叠子分类
- ✅ 缩进显示层级关系
- ✅ 显示每层的股票数量

**交互**:
- 点击 ▶️ 展开子分类
- 点击 ▼ 折叠子分类
- 默认全部展开

---

## 🎯 与股票菜单的区别

### 股票菜单
- **功能**: 查看和管理股票列表
- **包含**: 股票列表、分类筛选、快速操作
- **重点**: 股票数据和操作

### 分类菜单
- **功能**: 管理分类结构
- **包含**: 分类树、创建/编辑/删除分类
- **重点**: 分类组织和层级关系

**互补关系**:
- 分类菜单管理分类结构
- 股票菜单使用分类筛选
- 两者数据实时同步

---

## 💡 使用场景

### 场景1: 初次使用,搭建分类体系

1. 点击"分类"菜单
2. 创建顶级分类:
   - 行业板块
   - 交易策略
   - 持仓状态
3. 为每个顶级分类添加子分类
4. 完成后,在"股票"菜单中使用这些分类

### 场景2: 调整分类结构

1. 点击"分类"菜单
2. 找到需要调整的分类
3. 点击"编辑"
4. 修改父分类,调整层级关系
5. 保存

### 场景3: 清理无用分类

1. 点击"分类"菜单
2. 查看每个分类的股票数量
3. 找到股票数为0的分类
4. 点击"删除"清理

---

## 🔧 技术实现

### 核心组件
- **文件**: `components/categories/CategoriesView.tsx`
- **类型**: Client Component (使用'use client')
- **依赖**: Shadcn UI组件

### 数据结构

```typescript
interface Category {
  id: number;
  category_id: string;
  name: string;
  parent_id: string | null;
  path: string;
  level: number;
  icon: string | null;
  color: string | null;
  stock_count: number;        // 本分类股票数
  total_stock_count: number;  // 包含子分类
  children: Category[];
}
```

### API接口

```typescript
// 获取所有分类(树形结构)
GET /api/v1/categories/

// 创建分类
POST /api/v1/categories/
Body: { name, parent_id?, icon?, color? }

// 更新分类
PUT /api/v1/categories/{category_id}
Body: { name, parent_id?, icon?, color? }

// 删除分类
DELETE /api/v1/categories/{category_id}
```

---

## 📊 界面截图参考

### 统计卡片
```
┌─────────────┬─────────────┬─────────────┐
│ 总分类数    │ 顶级分类    │ 总股票数    │
│    15       │     3       │    150      │
│ 📁          │ 📂          │ 📊          │
└─────────────┴─────────────┴─────────────┘
```

### 分类树
```
📁 行业板块 (3 股票, 50 总计)  [编辑] [删除]
  ▼
  📂 科技股 (30 股票, 30 总计)  [编辑] [删除]
    📊 AI算力 (15 股票)  [编辑] [删除]
    🚀 半导体 (10 股票)  [编辑] [删除]
  📂 能源 (20 股票)  [编辑] [删除]
```

---

## ⚠️ 注意事项

### 1. 分类命名
- ✅ 使用有意义的名称
- ✅ 避免重复命名
- ✅ 简洁明了(建议2-6个字)

### 2. 层级设计
- ✅ 不要超过4级
- ✅ 合理规划层级关系
- ✅ 避免过于复杂的结构

### 3. 删除操作
- ⚠️ 删除前确认没有重要数据
- ⚠️ 考虑移动股票而非删除分类
- ⚠️ 备份重要分类结构

### 4. 后端依赖
- 需要后端API支持
- 确保后端服务运行在 `http://localhost:8000`
- API路径: `/api/v1/categories/`

---

## 🚀 快速操作

### 创建分类快捷键
无(暂不支持)

### 推荐工作流

1. **首次使用**:
   ```
   分类菜单 → 创建顶级分类 → 创建子分类 → 回到股票菜单
   ```

2. **日常使用**:
   ```
   股票菜单 → 使用分类筛选 → 偶尔调整分类结构
   ```

3. **重构分类**:
   ```
   分类菜单 → 查看统计 → 调整结构 → 清理无用分类
   ```

---

## 🔄 数据同步

### 实时同步
- ✅ 创建/编辑/删除立即生效
- ✅ 股票数量自动更新
- ✅ 与股票菜单实时同步

### 刷新机制
- 自动刷新: 操作后自动刷新列表
- 手动刷新: 刷新浏览器页面

---

## 📈 未来扩展

### 计划功能
- [ ] 批量导入分类
- [ ] 批量移动股票
- [ ] 分类模板
- [ ] 分类排序
- [ ] 拖拽调整层级
- [ ] 分类颜色预览
- [ ] 搜索分类
- [ ] 分类使用统计

---

## 🎓 最佳实践

### 1. 分类设计建议

**按行业**:
```
行业板块
├── 科技
│   ├── 互联网
│   ├── 半导体
│   └── 软件
├── 金融
└── 能源
```

**按策略**:
```
交易策略
├── 长线持有
├── 波段操作
└── 短线博弈
```

**按状态**:
```
持仓状态
├── 重仓
├── 轻仓
└── 观察
```

### 2. 命名规范
- 行业分类: 使用标准行业名称
- 策略分类: 使用交易术语
- 状态分类: 简洁明了

### 3. 维护建议
- 每月review一次分类结构
- 清理空分类
- 合并相似分类
- 调整层级关系

---

## 📞 反馈

如有问题或建议,欢迎反馈:
- 分类功能是否好用?
- 还需要哪些功能?
- 界面改进建议?

---

**功能开发**: 2025-10-18  
**版本**: v1.0  
**文件**: `components/categories/CategoriesView.tsx`  
**菜单位置**: 左侧菜单 → 📁 分类

