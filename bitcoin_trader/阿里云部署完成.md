# 🎉 高频短线策略 - 阿里云部署完成

## 📋 部署信息

- **服务器**: 101.42.14.209
- **部署目录**: `/opt/zhixing_trader/bitcoin_trader`
- **Python版本**: 3.9.18
- **部署时间**: 2024-10-23
- **策略版本**: v1.0.0

---

## ✅ 部署完成清单

### 1. 代码部署
- ✅ 高频策略核心代码已上传
- ✅ 测试文件已上传
- ✅ 配置文件已上传
- ✅ 文档已上传

### 2. 环境配置
- ✅ Python 3.9.18 已安装
- ✅ 虚拟环境已创建 (`venv/`)
- ✅ 所有依赖已安装（无 ta-lib，使用 numpy 实现）
- ✅ 依赖列表: `requirements_high_frequency.txt`

### 3. 数据库配置
- ✅ MySQL 已安装
- ✅ 数据库 `bitcoin_trader` 已存在
- ✅ 数据库连接配置正确

### 4. API 配置
- ✅ OKX API 密钥已配置
- ✅ 模拟盘模式已启用 (`OKX_TESTNET=True`)
- ✅ 配置文件: `.env`

### 5. 策略配置
- ✅ 策略参数已配置
- ✅ 配置文件: `strategy_configs/high_frequency_config.json`
- ✅ 初始资金: 300 USDT
- ✅ 杠杆: 3x

### 6. 测试验证
- ✅ 所有单元测试通过 (10/10)
- ✅ 技术指标计算正确
- ✅ 风险控制机制正常
- ✅ 仓位计算准确
- ✅ 止损止盈逻辑正确

---

## 🚀 快速启动

### 方式1: 直接运行（前台）

```bash
# SSH 登录服务器
ssh root@101.42.14.209

# 进入项目目录
cd /opt/zhixing_trader/bitcoin_trader

# 激活虚拟环境
source venv/bin/activate

# 启动模拟盘
python run_high_frequency_strategy.py --mode paper --capital 300
```

### 方式2: 使用启动脚本（推荐）

```bash
# SSH 登录服务器
ssh root@101.42.14.209

# 进入项目目录
cd /opt/zhixing_trader/bitcoin_trader

# 赋予执行权限
chmod +x start_high_frequency.sh

# 启动模拟盘
./start_high_frequency.sh paper 300

# 启动实盘（谨慎！）
./start_high_frequency.sh live 300
```

### 方式3: 后台运行（使用 screen）

```bash
# 创建 screen 会话
screen -S trading

# 进入项目目录
cd /opt/zhixing_trader/bitcoin_trader

# 激活虚拟环境并启动
source venv/bin/activate
python run_high_frequency_strategy.py --mode paper --capital 300

# 退出 screen（保持运行）
# 按 Ctrl+A，然后按 D

# 重新连接 screen
screen -r trading

# 停止策略
# 在 screen 中按 Ctrl+C

# 删除 screen 会话
screen -X -S trading quit
```

### 方式4: 后台运行（使用 nohup）

```bash
cd /opt/zhixing_trader/bitcoin_trader
source venv/bin/activate

# 后台运行
nohup python run_high_frequency_strategy.py --mode paper --capital 300 > logs/trading.log 2>&1 &

# 查看进程
ps aux | grep run_high_frequency_strategy

# 查看日志
tail -f logs/trading.log

# 停止进程
pkill -f run_high_frequency_strategy.py
```

---

## 📊 监控和管理

### 查看日志

```bash
# 实时查看最新日志
tail -f logs/trading_*.log

# 查看所有日志文件
ls -lh logs/

# 查看特定日期的日志
tail -f logs/trading_paper_20241023_*.log
```

### 查看运行状态

```bash
# 查看进程
ps aux | grep run_high_frequency_strategy

# 查看资源占用
top -p $(pgrep -f run_high_frequency_strategy.py)

# 查看网络连接
netstat -anp | grep python
```

### 停止策略

```bash
# 方式1: 如果在前台运行
# 按 Ctrl+C

# 方式2: 杀死进程
pkill -f run_high_frequency_strategy.py

# 方式3: 强制杀死
pkill -9 -f run_high_frequency_strategy.py
```

---

## ⚙️ 配置文件说明

### 1. 环境配置 (`.env`)

```bash
# 查看配置
cat .env

# 编辑配置
vi .env
```

**重要配置项**:
- `OKX_API_KEY`: OKX API 密钥
- `OKX_API_SECRET`: OKX API 密钥
- `OKX_PASSPHRASE`: OKX API 密码
- `OKX_TESTNET`: True=模拟盘, False=实盘
- `DB_HOST`: 数据库地址
- `DB_PASSWORD`: 数据库密码

### 2. 策略配置 (`strategy_configs/high_frequency_config.json`)

```bash
# 查看配置
cat strategy_configs/high_frequency_config.json

# 编辑配置
vi strategy_configs/high_frequency_config.json
```

**可调整参数**:
- `total_capital`: 总资金
- `leverage`: 杠杆倍数
- `max_daily_profit`: 单日最大盈利
- `max_daily_loss`: 单日最大亏损
- `max_consecutive_losses`: 最大连续亏损次数
- `max_trades_per_day`: 每日最大交易次数

---

## 🔧 常见问题

### 1. 依赖安装失败

```bash
# 重新安装依赖
cd /opt/zhixing_trader/bitcoin_trader
source venv/bin/activate
pip install -r requirements_high_frequency.txt
```

### 2. 数据库连接失败

```bash
# 测试数据库连接
mysql -uroot -pshuzhongren -e "SHOW DATABASES;"

# 检查 .env 配置
cat .env | grep DB_
```

### 3. OKX API 连接失败

```bash
# 检查 API 配置
cat .env | grep OKX_

# 测试网络连接
ping api.okx.com

# 检查是否使用模拟盘
# OKX_TESTNET=True 表示模拟盘
```

### 4. 策略无法启动

```bash
# 查看详细错误
python run_high_frequency_strategy.py --mode paper --capital 300

# 运行测试
python test_high_frequency_strategy.py

# 检查日志
tail -100 logs/trading_*.log
```

---

## ⚠️ 重要提醒

### 模拟盘测试（必须！）

1. **至少运行1周模拟盘**
2. **观察策略表现**:
   - 胜率是否达到 55-65%
   - 日收益是否在 2-4%
   - 最大回撤是否控制在 8% 以内
   - 交易频率是否在 3-8 次/天

3. **记录和分析**:
   - 每日交易记录
   - 盈亏分布
   - 最大连续亏损
   - 策略执行情况

### 实盘交易（谨慎！）

1. **小资金起步**: 建议 100-300 USDT
2. **严格风控**: 不要修改风控参数
3. **持续监控**: 每天检查交易情况
4. **及时止损**: 发现异常立即停止
5. **保持纪律**: 不要情绪化操作

### 风险声明

- ⚠️ 加密货币市场波动极大
- ⚠️ 可能损失全部本金
- ⚠️ 过去表现不代表未来收益
- ⚠️ 需要稳定的网络环境
- ⚠️ 需要持续监控和优化

---

## 📈 性能监控

### 关键指标

```bash
# 查看交易统计
grep "统计信息" logs/trading_*.log | tail -20

# 查看盈亏情况
grep "盈亏" logs/trading_*.log | tail -20

# 查看风控触发
grep "风险控制" logs/trading_*.log | tail -20
```

### 数据库查询

```bash
# 登录数据库
mysql -uroot -pshuzhongren bitcoin_trader

# 查看订单
SELECT * FROM orders ORDER BY created_at DESC LIMIT 10;

# 查看持仓
SELECT * FROM positions WHERE status='open';

# 查看策略统计
SELECT * FROM strategies WHERE name='HighFrequencyScalpingStrategy';
```

---

## 🔄 更新策略

### 本地修改代码后更新

```bash
# 本地提交代码
git add .
git commit -m "update: 优化策略参数"
git push origin main

# 服务器更新（如果 GitHub 可访问）
ssh root@101.42.14.209
cd /opt/zhixing_trader
git pull origin main

# 或者重新打包上传
# 本地
tar -czf /tmp/update.tar.gz bitcoin_trader/
scp /tmp/update.tar.gz root@101.42.14.209:/tmp/

# 服务器
cd /opt/zhixing_trader
tar -xzf /tmp/update.tar.gz
```

---

## 📞 技术支持

### 日志位置
- 交易日志: `/opt/zhixing_trader/bitcoin_trader/logs/`
- 系统日志: `/var/log/`

### 备份建议
- 定期备份数据库
- 定期备份日志文件
- 定期备份配置文件

---

## ✅ 部署验证

运行以下命令验证部署:

```bash
ssh root@101.42.14.209 << 'EOF'
cd /opt/zhixing_trader/bitcoin_trader
source venv/bin/activate
echo "=== Python 版本 ==="
python --version
echo ""
echo "=== 依赖检查 ==="
pip list | grep -E "(ccxt|pandas|numpy|sqlalchemy)"
echo ""
echo "=== 测试运行 ==="
python test_high_frequency_strategy.py
echo ""
echo "=== 配置检查 ==="
cat .env | grep -E "(OKX|DB)" | grep -v "SECRET\|PASSWORD"
echo ""
echo "✅ 部署验证完成！"
EOF
```

---

## 🎯 下一步

1. ✅ 部署完成
2. ⏳ 启动模拟盘测试（建议1周）
3. ⏳ 分析模拟盘数据
4. ⏳ 优化策略参数
5. ⏳ 小资金实盘测试
6. ⏳ 逐步增加资金

---

**祝交易顺利！🚀**

记住：短线交易的核心是纪律和执行力，不是预测精度！
