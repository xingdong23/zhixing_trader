# 快速开始 - OKX 模拟盘交易

## 🎯 目标

通过 OKX 模拟账户，完整体验自动化加密货币量化交易流程。

**预计时间**: 15-30 分钟

---

## 📋 准备工作

### 1. 系统要求

- Python 3.8 或更高版本
- 稳定的网络连接
- OKX 账户（免费注册）

### 2. 获取 OKX 模拟盘 API

#### 步骤 A: 注册 OKX 账户

1. 访问 https://www.okx.com
2. 点击右上角"注册"
3. 完成注册流程

#### 步骤 B: 开通模拟盘

1. 登录后，点击顶部菜单 **交易** → **模拟盘交易**
2. 系统自动分配模拟资金（通常 1,000,000 USDT）
3. 确认可以看到模拟盘界面

#### 步骤 C: 创建 API 密钥

1. 进入 **个人中心** → **API**
2. 点击 **创建 API**
3. **重要**: 选择 **模拟盘 API**（不是实盘！）
4. 设置权限：
   - ✅ 读取
   - ✅ 交易
   - ❌ 提现
5. 设置 **API 密码**（Passphrase）并记住
6. 完成验证后，保存以下信息：
   - API Key
   - Secret Key
   - Passphrase

⚠️ **注意**: Secret Key 只显示一次，请立即保存！

---

## 🚀 快速启动（3 步）

### 方法 1: 使用快速启动脚本（推荐）

```bash
# 1. 进入项目目录
cd bitcoin_trader

# 2. 给脚本添加执行权限
chmod +x 快速启动-OKX模拟盘.sh

# 3. 运行脚本
./快速启动-OKX模拟盘.sh
```

脚本会自动：
- ✅ 检查 Python 环境
- ✅ 安装依赖
- ✅ 创建配置文件
- ✅ 启动交易程序

### 方法 2: 手动配置

#### 第 1 步: 安装依赖

```bash
cd bitcoin_trader
pip install -r requirements.txt
```

#### 第 2 步: 配置环境变量

```bash
# 复制配置模板
cp .env.example .env

# 编辑配置文件
vim .env  # 或使用其他编辑器
```

在 `.env` 文件中填入你的 OKX API 信息：

```bash
# OKX 配置
OKX_API_KEY=你的API密钥
OKX_API_SECRET=你的Secret密钥
OKX_PASSPHRASE=你的API密码
OKX_TESTNET=True
```

#### 第 3 步: 运行交易程序

```bash
python examples/okx_demo_trading.py
```

---

## 🎮 使用流程

### 启动后的选项

```
请选择要运行的流程:

1. 测试 OKX 连接
2. 运行模拟交易 (Paper Trading - 不执行真实订单)
3. 运行实盘交易 (Live Trading - 在模拟盘执行真实订单)
4. 完整流程 (依次运行 1 → 2)
0. 退出
```

### 推荐流程

#### 第一次使用（新手）

**选择选项 1**: 测试连接

这会验证：
- ✅ API 配置是否正确
- ✅ 能否连接 OKX 模拟盘
- ✅ 账户余额
- ✅ 获取市场数据

**预期输出**:

```
════════════════════════════════════════════════════════════════
步骤1: 测试 OKX 模拟账户连接
════════════════════════════════════════════════════════════════

正在连接 OKX 模拟盘...

【账户余额】
  USDT: 1000000.0000
  BTC: 0.0000

【市场信息】
  BTC/USDT 当前价格: 67,234.50 USDT
  24h 涨跌幅: +2.34%
  24h 成交量: 12,345.67 BTC

【K线数据】
  获取最近 5 根 15分钟 K线:
    收盘价: 67,180.00
    收盘价: 67,210.50
    收盘价: 67,234.50

✅ OKX 模拟账户连接成功！
```

#### 第二步（熟悉流程）

**选择选项 2**: 运行模拟交易（Paper Trading）

特点：
- ✅ 完全模拟，不执行真实订单
- ✅ 测试策略逻辑
- ✅ 无任何风险
- ✅ 运行 5 分钟演示

**你会看到**:

```
🚀 机器人启动中...
════════════════════════════════════════════════════════════════

配置信息:
  交易所: OKX (模拟盘)
  交易对: BTC/USDT
  策略: 稳健盈利策略
  周期: 15分钟
  模式: Paper Trading (模拟)
  初始资金: 10,000 USDT
  最大仓位: 0.05 BTC
  日亏损限制: 2%

════════════════════════════════════════════════════════════════

[2025-10-18 16:00:00] INFO - 交易引擎初始化完成
[2025-10-18 16:00:01] INFO - 行情监控器启动
[2025-10-18 16:00:02] INFO - 订阅实时行情: BTC/USDT
[2025-10-18 16:00:03] INFO - 策略信号: hold - 未满足入场条件
...
```

#### 第三步（进阶测试）

**选择选项 3**: 运行实盘交易（Live Trading）

⚠️ **注意**: 这会在模拟盘执行真实订单！

特点：
- ⚠️ 真实下单、成交、平仓
- ✅ 使用模拟资金
- ✅ 完整测试交易流程
- ✅ 运行 10 分钟演示

---

## 📊 查看结果

### 运行中的日志

```
[2025-10-18 16:05:23] INFO - 策略信号: buy - 三线共振做多
[2025-10-18 16:05:24] INFO - 风险检查通过
[2025-10-18 16:05:25] INFO - 📝 模拟交易
[2025-10-18 16:05:25] INFO - 方向: BUY
[2025-10-18 16:05:25] INFO - 价格: 67234.50
[2025-10-18 16:05:25] INFO - 数量: 0.0149
[2025-10-18 16:05:25] INFO - 止损: 66234.50
```

### 最终报告

停止后会显示完整报告：

```
╔══════════════════════════════════════════════════════════════╗
║                    交易机器人性能报告                        ║
╚══════════════════════════════════════════════════════════════╝

【基本信息】
  交易对: BTC/USDT
  策略:   稳健盈利策略
  周期:   15m
  模式:   PAPER
  状态:   已停止

【交易统计】
  总交易: 2
  盈利:   1
  亏损:   1
  胜率:   50.0%
  持仓:   0
  挂单:   0

【资金状况】
  初始:   10,000.00 USDT
  当前:   10,075.00 USDT
  盈亏:   +75.00 USDT
  收益率: +0.75%

【最新信号】
  信号:   hold
  原因:   未满足入场条件
```

---

## 🔧 调整参数

### 修改策略参数

编辑 `examples/okx_demo_trading.py`，找到第 67-72 行：

```python
strategy = SteadyProfitStrategy(parameters={
    "base_position_ratio": 0.01,       # 基础仓位 1%
    "max_daily_loss": 0.02,            # 日亏损限制 2%
    "atr_multiplier": 1.5,             # 止损宽度
})
```

**调整建议**:

- **更保守**: `base_position_ratio=0.005`, `max_daily_loss=0.01`
- **更激进**: `base_position_ratio=0.02`, `max_daily_loss=0.05`

### 修改风险限制

找到第 75-82 行：

```python
risk_limits = RiskLimits(
    max_position_size=0.05,            # 最大仓位
    max_daily_loss=0.02,               # 日亏损限制
    max_trades_per_day=10,             # 每日交易次数
)
```

### 修改运行时间

找到第 126 行：

```python
await asyncio.sleep(300)  # 改为你想要的秒数
```

常用设置：
- `60` = 1 分钟（快速测试）
- `300` = 5 分钟（默认）
- `1800` = 30 分钟（充分测试）
- `3600` = 1 小时（长期运行）

---

## ❓ 常见问题

### Q1: 连接失败

**错误**: `❌ 连接失败: Authentication failed`

**解决**:
1. 检查 API 配置是否正确（注意空格）
2. 确认使用的是**模拟盘 API**
3. 验证 Passphrase 是否正确
4. 重新创建 API 密钥

### Q2: 没有交易信号

**原因**: 策略较为保守，需要满足多个条件

**解决**:
- 耐心等待（可能需要几分钟到几小时）
- 调整策略参数使其更激进
- 使用更短的时间周期（5m 代替 15m）
- 在市场波动大的时候运行

### Q3: 如何停止机器人

**方法**:
- 按 `Ctrl + C` 键
- 机器人会安全停止并显示报告

### Q4: 模拟资金用完了

**解决**:
- 登录 OKX 网页版模拟盘
- 点击"重置账户"
- 系统会重新分配模拟资金

### Q5: 想切换到实盘

⚠️ **强烈建议**:
1. 在模拟盘至少运行 1 周
2. 确认策略稳定盈利
3. 理解所有风险
4. 从小资金开始（100-1000 USDT）

**切换步骤**:
1. 创建实盘 API 密钥
2. 更新 `.env`: `OKX_TESTNET=False`
3. 使用更严格的风险限制
4. 谨慎操作！

---

## 📚 进阶学习

### 推荐阅读顺序

1. **基础**: [OKX模拟盘配置指南.md](./OKX模拟盘配置指南.md)
2. **策略**: [稳健盈利策略.md](./稳健盈利策略.md)
3. **技术**: [CCXT集成指南.md](./CCXT集成指南.md)
4. **开发**: [自定义策略开发.md](./自定义策略开发.md)

### 下一步行动

- [ ] 运行 1 天，观察策略表现
- [ ] 尝试调整参数，优化策略
- [ ] 测试多个交易对（ETH/USDT, BNB/USDT）
- [ ] 学习编写自己的策略
- [ ] 进行回测验证

---

## 🎉 恭喜！

你已经完成了 OKX 模拟盘的配置和运行！

**接下来**:
- 让机器人运行一段时间
- 观察交易信号和执行情况
- 分析性能报告
- 根据结果调整参数

**记住**:
- ✅ 先充分测试
- ✅ 理解风险
- ✅ 从小做起
- ✅ 持续学习

祝交易顺利！🚀
