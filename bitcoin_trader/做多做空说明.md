# 做多做空策略说明

## 是的！策略既可以做多也可以做空 ✅

本策略是**双向交易策略**，可以根据市场情况自动选择做多或做空。

## 做多（买入开仓）

### 触发条件
当**所有**以下条件同时满足时，触发做多信号：

1. **EMA金叉**：EMA8上穿EMA21
   ```python
   prev_ema8 <= prev_ema21 and current_ema8 > current_ema21
   ```

2. **成交量突增**：当前成交量 > 前5根均值的1.5倍
   ```python
   current_volume > avg_volume * 1.5
   ```

3. **RSI突破**：RSI从低于45区域向上突破
   ```python
   prev_rsi < 45 and current_rsi >= 45
   ```

4. **价格突破**：价格突破前15分钟高点
   ```python
   current_price > recent_high * 1.001
   ```

5. **MACD确认**：MACD柱状线转势向上
   ```python
   current_macd > prev_macd
   ```

### 做多逻辑
- **看涨**：预期价格上涨
- **买入开仓**：建立多头仓位
- **盈利方式**：价格上涨时盈利
- **止损**：价格下跌0.8%-1.2%
- **止盈**：价格上涨1.5%-2.5%

## 做空（卖出开仓）

### 触发条件
当**所有**以下条件同时满足时，触发做空信号：

1. **EMA死叉**：EMA8下穿EMA21
   ```python
   prev_ema8 >= prev_ema21 and current_ema8 < current_ema21
   ```

2. **成交量突增**：当前成交量 > 前5根均值的1.5倍
   ```python
   current_volume > avg_volume * 1.5
   ```

3. **RSI跌破**：RSI从高于55区域向下跌破
   ```python
   prev_rsi > 55 and current_rsi <= 55
   ```

4. **价格跌破**：价格跌破前15分钟低点
   ```python
   current_price < recent_low * 0.999
   ```

5. **MACD确认**：MACD柱状线转势向下
   ```python
   current_macd < prev_macd
   ```

### 做空逻辑
- **看跌**：预期价格下跌
- **卖出开仓**：建立空头仓位
- **盈利方式**：价格下跌时盈利
- **止损**：价格上涨0.8%-1.2%
- **止盈**：价格下跌1.5%-2.5%

## 代码实现

### 做多信号生成
```python
# 做多信号检查
long_conditions = {
    "ema_cross": prev_ema8 <= prev_ema21 and current_ema8 > current_ema21,
    "volume_surge": volume_surge,
    "rsi_condition": prev_rsi < 45 and current_rsi >= 45,
    "price_breakout": current_price > recent_high * 1.001,
    "macd_confirm": current_macd > prev_macd,
}

if all(long_conditions.values()):
    return {
        "signal": "buy",  # 做多
        "price": current_price,
        "amount": position_size,
        "stop_loss": stop_loss,
        "take_profit": take_profit,
        "reason": "做多信号触发"
    }
```

### 做空信号生成
```python
# 做空信号检查
short_conditions = {
    "ema_cross": prev_ema8 >= prev_ema21 and current_ema8 < current_ema21,
    "volume_surge": volume_surge,
    "rsi_condition": prev_rsi > 55 and current_rsi <= 55,
    "price_breakout": current_price < recent_low * 0.999,
    "macd_confirm": current_macd < prev_macd,
}

if all(short_conditions.values()):
    return {
        "signal": "sell",  # 做空
        "price": current_price,
        "amount": position_size,
        "stop_loss": stop_loss,
        "take_profit": take_profit,
        "reason": "做空信号触发"
    }
```

## 交易示例

### 做多示例
```
场景：ETH价格从2400上涨到2500

1. 入场：2400 USDT（做多开仓）
2. 止损：2380 USDT（-0.83%）
3. 止盈：2450 USDT（+2.08%）

如果价格涨到2450：
- 盈利：50 USDT
- 收益率：2.08%
- 杠杆3倍：实际收益率 6.24%
```

### 做空示例
```
场景：ETH价格从2500下跌到2400

1. 入场：2500 USDT（做空开仓）
2. 止损：2520 USDT（+0.8%）
3. 止盈：2450 USDT（-2%）

如果价格跌到2450：
- 盈利：50 USDT
- 收益率：2%
- 杠杆3倍：实际收益率 6%
```

## 策略优势

### ✅ 双向盈利
- **上涨行情**：做多赚钱
- **下跌行情**：做空赚钱
- **震荡行情**：持币观望

### ✅ 严格条件
- 需要5个条件同时满足
- 降低假信号
- 提高胜率

### ✅ 风险控制
- 每笔交易都有止损
- 每笔交易都有止盈
- 盈亏比1.5:1 - 2:1

## 日志示例

### 做多开仓
```
🔔 交易信号触发!
  信号: buy
  价格: 2400.50
  数量: 0.125
  止损: 2380.00
  止盈: 2450.00

✓ [模拟盘] 做多开仓成功: {...}
```

### 做空开仓
```
🔔 交易信号触发!
  信号: sell
  价格: 2500.00
  数量: 0.120
  止损: 2520.00
  止盈: 2450.00

✓ [模拟盘] 做空开仓成功: {...}
```

## 注意事项

### ⚠️ 条件严格
- 5个条件必须**全部**满足
- 不会频繁交易
- 等待最佳时机

### ⚠️ 单向持仓
- 同一时间只能持有一个方向的仓位
- 做多时不能做空
- 做空时不能做多
- 必须先平仓才能反向开仓

### ⚠️ 风险提示
- 做多和做空风险相同
- 都有爆仓风险
- 严格遵守止损

## 如何查看信号

运行时会显示：
```
策略信号: buy - 做多信号触发 - 早盘突破
策略信号: sell - 做空信号触发 - 美盘联动
策略信号: hold - 未满足入场条件
```

## 总结

✅ **策略特点**
- 可以做多做空
- 双向盈利机会
- 条件严格，信号可靠

✅ **适用场景**
- 趋势行情（上涨或下跌）
- 成交量放大
- 技术指标共振

⚠️ **不适用场景**
- 极端震荡
- 成交量萎缩
- 单日亏损超限

现在你知道了，这是一个完整的双向交易策略！🎯
